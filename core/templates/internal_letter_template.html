{% extends "base_letter_template.html" %}

{% load static %}

{% block title %}Letter_{{ letter.reference_number }}{% endblock %}

{% block header %}<header class="internal_letter_header"></header>{% endblock %}

{% block separator %} {% endblock %}

{% block letter_metadata %}
  <section class="letter-metadata">
    <div class="metadata-item">
      <p class="metadata-label">
        <span>ቁጥር</span>
        <span>Ref.No.</span>
      </p>
      <div class="metadata-value-container">
        <span class="metadata-value">
          {% if letter.language == "EN" %}
            {% if letter.reference_number %}
              {{ letter.reference_number }}
            {% else %}
              N/A
            {% endif %}
          {% elif letter.language == "AM" %}
            {% if letter.reference_number_am %}
              {{ letter.reference_number_am }}
            {% else %}
              N/A
            {% endif %}
          {% endif %}
        </span>
        <hr class="metadata-divider" />
      </div>
    </div>
    <div class="metadata-item">
      <p class="metadata-label">
        <span>ቀን</span>
        <span>Date</span>
      </p>
      <div class="metadata-value-container">
        <span class="metadata-value">
          {% if letter.published_at %}
            {{ letter.published_at }}
          {% else %}
            N/A
          {% endif %}
        </span>
        <hr class="metadata-divider" />
      </div>
    </div>
  </section>
{% endblock %}

{% block authors %} {% endblock %}

{% block primary_recipients %}
  <section class="pr-participant-section">
    {% if letter.language == "EN" %}
      {% for participant in primary_recipients %}
        {% if participant.user %}
          <p class="pr-participant-item">To {{participant.user.job_title.title_en}}</p>
          <span class="address">M.I.N.T</span>
        {% elif participant.enterprise %}
          <p class="pr-participant-item">To {{participant.enterprise.name_en}}</p>
          <span class="address">{{participant.enterprise.address.city_en}}</span>
        {% elif participant.contact %}
          <p class="pr-participant-item">To {{participant.contact.full_name_en}}</p>
          <span class="address">{{participant.contact.address.city_en}}</span>
        {% endif %}
      {% endfor %}
    {% elif letter.language == "AM" %}
      {% for participant in primary_recipients %}
        {% if participant.user %}
          <p class="pr-participant-item">ለ {{participant.user.job_title.title_am}}</p>
          <span class="address">ኢ.ቴ.ሚ</span>
        {% elif participant.enterprise %}
          <p class="pr-participant-item">ለ {{participant.enterprise.name_am}}</p>
          <span class="address">{{participant.enterprise.address.city_am}}</span>
        {% elif participant.contact %}
          <p class="pr-participant-item">ለ {{participant.contact.full_name_am}}</p>
          <span class="address">{{participant.contact.address.city_am}}</span>
        {% endif %}
      {% endfor %}
    {% endif %}
  </section>
{% endblock %}

{% block letter_body %}
  <section class="letter-body">
    <p class="letter-subject">
      <span class="subject-label">
        {% if letter.language == "EN" %}
          Subject
        {% elif letter.language == "AM" %}
          ጉዳዩ
        {% endif %}
        :-</span>{{letter.subject}}
    </p>

    <div class="letter-body">{{ letter.body|safe }}</div>
  </section>
{% endblock %}

{% block e_signatures %}
  <section class="e-signatures">
    <span class="closing-phrase">
      {% if letter.language == "EN" %}
        Sincerely,
      {% elif letter.language == "AM" %}
        ከሰላምታ ጋር
      {% endif %}
    </span>
    {% for e_signature in e_signatures %}
      <div class="signature-item">
        <img
          src="{{ base_url }}{{ e_signature.signature_image.url }}"
          alt="{{ e_signature.signer.full_name_en }}'s signature"
          class="signature-image"
        />
        <p class="signer-info">
          {% if letter.language == "EN" %}
            <span>{{ e_signature.signer.full_name_en }}</span>
            <span>{{ e_signature.signer.job_title.title_en }}</span>
          {% elif letter.language == "AM" %}
            <span>{{ e_signature.signer.full_name_am }}</span>
            <span>{{ e_signature.signer.job_title.title_am }}</span>
          {% endif %}
        </p>
      </div>
    {% endfor %}
  </section>
{% endblock %}

{% block footer %} {% endblock %}
